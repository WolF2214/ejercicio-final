{% extends 'base.html' %}

{% block content %}

{% if request.user.is_authenticated %}

<link href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/css/bootstrap-datetimepicker.css" rel="stylesheet"/>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.2/moment.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.37/js/bootstrap-datetimepicker.min.js"></script>


{% endif %}
    <h1>My To do List{{color}}</h1>
    <br>
    <a class="btn btn-success" href="{% url 'task-create' %}">New Task</a >
    </div>
    <div class="col col-sm-12 col-lg-8"></div>
    </div>
    <br>
    <div>  
        <form method="GET">
            {{ filter.form }}
            <button style="margin: 5px" type="submit" class="btn btn-dark">Filter</button>
            <br>
        </form>
    </div>
    <br>
    <div class="container-flex justify-content-center">
      <div class="col ">
        <table class="table table-success table-striped" id="my-table">
            <thead>
                <th>UserName</th>
                <th id='title1'>Task</th> 
                <th class="title">Description</th>
                <th>State</th>
                <th>Expired Date</th>
                <th></th>
                <th></th>
            </thead>
            <body>
                {% for task in filter.qs %} <!--si cambio filter.qs por tasks -->
                <tr>
                    <td>{{task.user}}</td>
                    <td>{{task.name}}</td>
                    <td>{{task.description}}</td>
                    <td>{{task.state}}</td>
                    <td>
                        {% if tasks.is_past_due %}
                        <p class="text-danger">tarea vencida desde {{ task.expire_date }}</p>
                        {% else %}
                        {{ task.expire_date }}
                        {% endif %}
                    </td>
                    <td><a href="{% url 'task-update' task.id %}">Detail</a></td>
                    <td><a href="{% url 'task-delete' task.id %}">Delete</a></td>
                </tr>
                {% empty %}
                <h3>No items in list</h3>
                {% endfor %}
            </body>
        </table>
    </div>
</div>

<br>

{% endblock content %}    
  